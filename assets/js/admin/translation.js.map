{"version":3,"file":"admin/translation.js","sources":["admin/translation.js"],"sourcesContent":["jQuery(document).ready(function ($) {\r\n\r\n    /**\r\n     * Resize text area\r\n     */\r\n\r\n    function wplngResizeTextArea($element) {\r\n        $element.height(0);\r\n        $element.height($element[0].scrollHeight);\r\n    }\r\n\r\n    var $wplngTextArea = $(\"#wplng_meta_box_translation textarea\");\r\n\r\n    $wplngTextArea.off(\"keyup.textarea\").on(\"keyup.textarea\", function () {\r\n        wplngResizeTextArea($(this));\r\n    });\r\n\r\n    $(window).resize(function () {\r\n        $wplngTextArea.each(function () {\r\n            wplngResizeTextArea($(this));\r\n        });\r\n    });\r\n\r\n    $wplngTextArea.each(function () {\r\n        wplngResizeTextArea($(this));\r\n    });\r\n\r\n    /**\r\n     * Review\r\n     */\r\n\r\n    $('.wplng-edit-language .wplng-mark-as-reviewed input[type=\"checkbox\"]').change(function () {\r\n\r\n        var parentSelector = $(\"#wplng-translation-\" + $(this).attr(\"wplng-lang\"));\r\n\r\n        parentSelector.removeClass(\"wplng-status-generated\");\r\n        parentSelector.removeClass(\"wplng-status-reviewed\");\r\n        parentSelector.removeClass(\"wplng-status-ungenerated\");\r\n\r\n        if (this.checked) {\r\n            parentSelector.addClass(\"wplng-status-reviewed\");\r\n        } else {\r\n            parentSelector.addClass(\"wplng-status-generated\");\r\n        }\r\n    });\r\n\r\n    $('.wplng-edit-language textarea').each(function () {\r\n        var reviewSelector = $(\"#wplng_mark_as_reviewed_\" + $(this).attr(\"lang\"));\r\n        reviewSelector.prop(\"disabled\", $(this).val().trim() == \"\");\r\n    });\r\n\r\n    $('.wplng-edit-language textarea').on(\"keyup paste\", function () {\r\n\r\n        var parentSelector = $(\"#wplng-translation-\" + $(this).attr(\"lang\"));\r\n        var reviewSelector = $(\"#wplng_mark_as_reviewed_\" + $(this).attr(\"lang\"));\r\n\r\n        parentSelector.removeClass(\"wplng-status-generated\");\r\n        parentSelector.removeClass(\"wplng-status-reviewed\");\r\n        parentSelector.removeClass(\"wplng-status-ungenerated\");\r\n\r\n        if ($(this).val().trim() == \"\") {\r\n            parentSelector.addClass(\"wplng-status-ungenerated\");\r\n            reviewSelector.prop(\"checked\", false);\r\n            reviewSelector.prop(\"disabled\", true);\r\n        } else {\r\n            parentSelector.addClass(\"wplng-status-reviewed\");\r\n            reviewSelector.prop(\"checked\", true);\r\n            reviewSelector.prop(\"disabled\", false);\r\n        }\r\n\r\n    });\r\n\r\n    /**\r\n     * Ajax translation\r\n     */\r\n\r\n    $(\".wplng-generate-spin\").hide();\r\n\r\n    $(\".wplng-generate\").on(\"click\", function () {\r\n\r\n        if (\"disabled\" == $(this).attr(\"disabled\")) {\r\n            return;\r\n        }\r\n\r\n        var source = $(\"#wplng-original-language\").attr(\"wplng-lang\");\r\n        var target = $(this).attr(\"wplng-lang\");\r\n        var text = $(\"#wplng-source\").html();\r\n\r\n        if (undefined == source || undefined == target || undefined == text) {\r\n            return;\r\n        }\r\n\r\n        var container = \"#wplng-translation-\" + target;\r\n\r\n        $(container + \" .wplng-generate\").attr(\"disabled\", true);\r\n        $(container + \" .wplng-generate-spin\").show();\r\n\r\n        $.ajax({\r\n            url: wplngLocalize.ajaxUrl,\r\n            method: 'POST',\r\n            data: {\r\n                action: 'wplng_ajax_translation',\r\n                text: text,\r\n                language_source: source,\r\n                language_target: target\r\n            },\r\n            success: function (data) {\r\n                if (data.success) {\r\n                    var textarea = \"#wplng_translation_\" + target;\r\n                    $(textarea).val(data.data);\r\n\r\n                    if (data.data != \"\") {\r\n                        var parentSelector = $(\"#wplng-translation-\" + target);\r\n                        var reviewSelector = $(\"#wplng_mark_as_reviewed_\" + target);\r\n\r\n                        parentSelector.removeClass(\"wplng-status-generated\");\r\n                        parentSelector.removeClass(\"wplng-status-reviewed\");\r\n                        parentSelector.removeClass(\"wplng-status-ungenerated\");\r\n\r\n                        parentSelector.addClass(\"wplng-status-reviewed\");\r\n                        reviewSelector.prop(\"checked\", true);\r\n                        reviewSelector.prop(\"disabled\", false);\r\n                    }\r\n\r\n                    wplngResizeTextArea($(textarea));\r\n\r\n                    $(container + \" .wplng-generate-spin\").hide();\r\n                    setTimeout(function () {\r\n                        $(container + \" .wplng-generate\").attr(\"disabled\", false);\r\n                    }, 8000);\r\n                } else {\r\n                    console.log(\"wpLingua - Error:\");\r\n                    console.log(data);\r\n                    $(container + \" .wplng-generate-spin\")\r\n                        .removeClass(\"dashicons-update\")\r\n                        .removeClass(\"wplng-spin\")\r\n                        .addClass(\"dashicons-no\");\r\n                }\r\n            },\r\n            error: function (data) {\r\n                console.log(\"wpLingua - Error:\");\r\n                console.log(data);\r\n                $(container + \" .wplng-generate-spin\")\r\n                    .removeClass(\"dashicons-update\")\r\n                    .removeClass(\"wplng-spin\")\r\n                    .addClass(\"dashicons-no\");\r\n            }\r\n        });\r\n\r\n    });\r\n\r\n    /**\r\n     * Alert if page is leave without saving\r\n     */\r\n\r\n    let wplngIsUpdatePost = false;\r\n    let wplngInputSignature = {\r\n        onload: wplngGetInputSignature(),\r\n        now: wplngGetInputSignature()\r\n    };\r\n\r\n    $(\".wplng-edit-language textarea, .wplng-edit-language input\").on(\"change input propertychange\", function() {\r\n        wplngInputSignature.now = wplngGetInputSignature();\r\n    });\r\n\r\n    function wplngGetInputSignature() {\r\n\r\n        let signature = \"\";\r\n\r\n        $(\".wplng-edit-language textarea\").each(function() {\r\n            signature += $(this).val();\r\n        });\r\n\r\n        $(\".wplng-edit-language input[type=checkbox]\").each(function() {\r\n            signature += $(this).prop(\"checked\");\r\n        });\r\n\r\n        return signature;\r\n    }\r\n\r\n    jQuery('[type=submit]').click(function () {\r\n        wplngIsUpdatePost = true;\r\n    });\r\n\r\n    $(window).on('beforeunload', function () {\r\n        if (!wplngIsUpdatePost\r\n            && wplngInputSignature.onload != wplngInputSignature.now\r\n        ) {\r\n            return confirm(wplngLocalize.leaveMessage);\r\n        }\r\n    });\r\n\r\n}); // End jQuery loaded event"],"names":["jQuery","document","ready","$","wplngResizeTextArea","$element","height","scrollHeight","$wplngTextArea","off","on","this","window","resize","each","change","parentSelector","attr","removeClass","checked","addClass","prop","val","trim","reviewSelector","hide","source","target","text","container","html","undefined","show","ajax","url","wplngLocalize","ajaxUrl","method","data","action","language_source","language_target","success","textarea","setTimeout","console","log","error","let","wplngIsUpdatePost","wplngInputSignature","onload","wplngGetInputSignature","now","signature","click","confirm","leaveMessage"],"mappings":"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"}