
jQuery(document).ready(function($){function wplngResizeTextArea($element){$element.height(0);$element.height($element[0].scrollHeight);}
var $wplngTextArea=$("#wplng_meta_box_translation textarea");$wplngTextArea.off("keyup.textarea").on("keyup.textarea",function(){wplngResizeTextArea($(this));});$(window).resize(function(){$wplngTextArea.each(function(){wplngResizeTextArea($(this));});});$wplngTextArea.each(function(){wplngResizeTextArea($(this));});$('.wplng-edit-language .wplng-mark-as-reviewed input[type="checkbox"]').change(function(){var parentSelector=$("#wplng-translation-"+$(this).attr("wplng-lang"));parentSelector.removeClass("wplng-status-generated");parentSelector.removeClass("wplng-status-reviewed");parentSelector.removeClass("wplng-status-ungenerated");if(this.checked){parentSelector.addClass("wplng-status-reviewed");}else{parentSelector.addClass("wplng-status-generated");}});$('.wplng-edit-language textarea').each(function(){var reviewSelector=$("#wplng_mark_as_reviewed_"+$(this).attr("lang"));reviewSelector.prop("disabled",$(this).val().trim()=="");});$('.wplng-edit-language textarea').on("keyup paste",function(){var parentSelector=$("#wplng-translation-"+$(this).attr("lang"));var reviewSelector=$("#wplng_mark_as_reviewed_"+$(this).attr("lang"));parentSelector.removeClass("wplng-status-generated");parentSelector.removeClass("wplng-status-reviewed");parentSelector.removeClass("wplng-status-ungenerated");if($(this).val().trim()==""){parentSelector.addClass("wplng-status-ungenerated");reviewSelector.prop("checked",false);reviewSelector.prop("disabled",true);}else{parentSelector.addClass("wplng-status-reviewed");reviewSelector.prop("checked",true);reviewSelector.prop("disabled",false);}});$(".wplng-generate-spin").hide();$(".wplng-generate").on("click",function(){if("disabled"==$(this).attr("disabled")){return;}
var source=$("#wplng-original-language").attr("wplng-lang");var target=$(this).attr("wplng-lang");var text=$("#wplng-source").html();if(undefined==source||undefined==target||undefined==text){return;}
var container="#wplng-translation-"+target;$(container+" .wplng-generate").attr("disabled",true);$(container+" .wplng-generate-spin").show();$.ajax({url:adminAjax.ajaxurl,method:'POST',data:{action:'wplng_ajax_translation',text:text,language_source:source,language_target:target},success:function(data){if(data.success){var textarea="#wplng_translation_"+target;$(textarea).val(data.data);if(data.data!=""){var parentSelector=$("#wplng-translation-"+target);var reviewSelector=$("#wplng_mark_as_reviewed_"+target);parentSelector.removeClass("wplng-status-generated");parentSelector.removeClass("wplng-status-reviewed");parentSelector.removeClass("wplng-status-ungenerated");parentSelector.addClass("wplng-status-generated");reviewSelector.prop("checked",false);}
wplngResizeTextArea($(textarea));$(container+" .wplng-generate-spin").hide();setTimeout(function(){$(container+" .wplng-generate").attr("disabled",false);},8000);}else{console.log("wpLingua - Error:");console.log(data);$(container+" .wplng-generate-spin").removeClass("dashicons-update").removeClass("wplng-spin").addClass("dashicons-no");}},error:function(data){console.log("wpLingua - Error:");console.log(data);$(container+" .wplng-generate-spin").removeClass("dashicons-update").removeClass("wplng-spin").addClass("dashicons-no");}});});});