jQuery(document).ready(function(o){let s=o("#wplng-translation-editor");function g(e){e.height(0),e.height(e[0].scrollHeight)}function d(){o("#wplng-modal-edit-container").hide(),o("#wplng-modal-edit-save").prop("disabled",!1),o("#wplng-modal-container").show(),a.onload="",a.now=""}function l(){n=!1,a={onload:t(),now:t()};let e=s.find(".wplng-edit-language textarea");e.off("keyup.textarea").on("keyup.textarea",function(){g(o(this))}),o(window).resize(function(){e.each(function(){g(o(this))})}),e.each(function(){g(o(this))}),s.find('.wplng-mark-as-reviewed input[type="checkbox"]').change(function(){var e=s.find("#wplng-translation-"+o(this).attr("wplng-lang"));e.removeClass("wplng-status-generated"),e.removeClass("wplng-status-reviewed"),e.removeClass("wplng-status-ungenerated"),this.checked?e.addClass("wplng-status-reviewed"):e.addClass("wplng-status-generated")}),s.find(".wplng-edit-language textarea").each(function(){s.find("#wplng_mark_as_reviewed_"+o(this).attr("lang")).prop("disabled",""==o(this).val().trim())}),s.find(".wplng-edit-language textarea").on("keyup paste",function(){var e=s.find("#wplng-translation-"+o(this).attr("lang")),n=s.find("#wplng_mark_as_reviewed_"+o(this).attr("lang"));e.removeClass("wplng-status-generated"),e.removeClass("wplng-status-reviewed"),e.removeClass("wplng-status-ungenerated"),""==o(this).val().trim()?(e.addClass("wplng-status-ungenerated"),n.prop("checked",!1),n.prop("disabled",!0)):(e.addClass("wplng-status-reviewed"),n.prop("checked",!0),n.prop("disabled",!1))}),s.find(".wplng-generate-spin").hide(),s.find(".wplng-generate").on("click",function(){var e,l,n,i;"disabled"!=o(this).attr("disabled")&&(e=s.find("#wplng-original-language").attr("wplng-lang"),l=s.find(this).attr("wplng-lang"),n=s.find("#wplng-source").html(),null!=e)&&null!=l&&null!=n&&(i="#wplng-translation-"+l,s.find(i+" .wplng-generate").attr("disabled",!0),s.find(i+" .wplng-generate-spin").show(),o.ajax({url:wplngLocalize.ajaxUrl,method:"POST",data:{action:"wplng_ajax_translation",text:n,language_source:e,language_target:l},success:function(e){var n,a,t;e.success?(o(n="#wplng_translation_"+l).val(e.data),""!=e.data&&(a=s.find("#wplng-translation-"+l),t=s.find("#wplng_mark_as_reviewed_"+l),a.removeClass("wplng-status-generated"),a.removeClass("wplng-status-reviewed"),a.removeClass("wplng-status-ungenerated"),a.addClass("wplng-status-reviewed"),t.prop("checked",!0),t.prop("disabled",!1)),g(o(n)),r(),o(i+" .wplng-generate-spin").hide(),setTimeout(function(){s.find(i+" .wplng-generate").attr("disabled",!1)},8e3)):(console.log("wpLingua - Error:"),console.log(e),s.find(i+" .wplng-generate-spin").removeClass("dashicons-update").removeClass("wplng-spin").addClass("dashicons-no"))},error:function(e){console.log("wpLingua - Error:"),console.log(e),s.find(i+" .wplng-generate-spin").removeClass("dashicons-update").removeClass("wplng-spin").addClass("dashicons-no")}}))}),s.find(".wplng-edit-language textarea, .wplng-edit-language input").on("change input propertychange",r),o("#submitpost [type=submit], #wplng-modal-edit-save").click(function(){n=!0}),o(window).on("beforeunload",function(){if(!n&&a.onload!=a.now)return confirm(wplngLocalize.message.exitPage)})}o("#wplng-modal-edit-show-all").on("click",function(){o(this).hide(),s.find(".wplng-edit-language").show()});let n=!1,a={onload:t(),now:t()};function t(){let e="";return s.find(".wplng-edit-language textarea").each(function(){e+=o(this).val()}),s.find(".wplng-edit-language input[type=checkbox]").each(function(){e+=o(this).prop("checked")}),e}function r(){a.now=t(),a.onload==a.now?o("#wplng-modal-edit-save").prop("disabled",!0):o("#wplng-modal-edit-save").prop("disabled",!1)}l(),o(".wplng-edit-link[wplng_post]").click(function(){o("#wplng-modal-edit-save").text(wplngLocalize.message.buttonSave),o("#wplng-modal-edit-save").prop("disabled",!0);let a=o(this).attr("wplng_post"),t=o("#wplng-modal-edit-post").attr("data-wplng-edit-template");t=t.replace("WPLNG_TRANSLATION_ID",a),o.ajax({url:wplngLocalize.ajaxUrl,method:"POST",data:{action:"wplng_ajax_edit_modal",post_id:a},success:function(e){var n;e.success?(n=function(e){let n=e;return n=(n=(n=(n=(n=n.replace(/&nbsp;/gi," ")).replace(/&amp;/gi,"&")).replace(/&quot;/gi,'"')).replace(/&lt;/gi,"<")).replace(/&gt;/gi,">")}((n=JSON.parse(e.data)).wplng_edit_html),s.html(n),o("#wplng-modal-edit-post").attr("href",t),o("#wplng-modal-edit-container").show(),o("#wplng-modal-container").hide(),o("#wplng-modal-edit-save").attr("wplng_post",a),1==s.find(".wplng-edit-language").length?o("#wplng-modal-edit-show-all").hide():o("#wplng-modal-edit-show-all").show(),l(),n=(n=".wplng-edit-language:not([wplng-lang=")+wplngLocalize.currentLanguage+"])",s.find(n).hide()):(console.log("wpLingua - Error:"),console.log(e))},error:function(e){console.log("wpLingua - Error:"),console.log(e)}})}),o("#wplng-modal-edit-return").click(function(){(a.onload==a.now||confirm(wplngLocalize.message.exitEditorModal))&&d()}),o("#wplng-modal-edit-save").click(function(){o("#wplng-modal-edit-save").text(wplngLocalize.message.buttonSaveInProgress);let t=o(this).text(),l=o(this).attr("wplng_post"),n={action:"wplng_ajax_save_modal",post_id:l,wplng_translation_meta_box_nonce:s.find("#wplng_translation_meta_box_nonce").val()},i=(s.find(".wplng-translation-textarea").each(function(){var e=o(this).attr("id");n[e]=o(this).val(),"wplng_translation_"+wplngLocalize.currentLanguage==e&&(t=o(this).val())}),1==o("#wplng_mark_as_reviewed_"+wplngLocalize.currentLanguage).prop("checked"));s.find(".wplng-mark-as-reviewed input[type=checkbox]").each(function(){n[o(this).attr("id")]=o(this).prop("checked")}),o.ajax({url:wplngLocalize.ajaxUrl,method:"POST",data:n,success:function(e){var n,a;e.success?(n=o("body.wplingua-editor .wplng-edit-link[wplng_post="+l+"]"),a=o("body.wplingua-list .wplng-modal-item[wplng_post="+l+"]"),n.text(t),a.find(".wplng-item-translation").text(t),i?(n.addClass("wplng-is-review"),a.addClass("wplng-is-review")):(n.removeClass("wplng-is-review"),a.removeClass("wplng-is-review")),d()):(console.log("wpLingua - Error:"),console.log(e))},error:function(e){console.log("wpLingua - Error:"),console.log(e)}})})});//# sourceMappingURL=translation.js.map
