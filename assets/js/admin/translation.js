jQuery(document).ready(function(o){let s=o("#wplng-translation-editor");function g(n){n.height(0),n.height(n[0].scrollHeight)}function l(){o("#wplng-modal-edit-container").hide(),o("#wplng-modal-edit-save").prop("disabled",!1),o("#wplng-modal-container").show(),a.onload="",a.now=""}function t(){e=!1,a={onload:i(),now:i()};let n=s.find(".wplng-edit-language textarea");n.off("keyup.textarea").on("keyup.textarea",function(){g(o(this))}),o(window).resize(function(){n.each(function(){g(o(this))})}),n.each(function(){g(o(this))}),s.find('.wplng-mark-as-reviewed input[type="checkbox"]').change(function(){var n=s.find("#wplng-translation-"+o(this).attr("wplng-lang"));n.removeClass("wplng-status-generated"),n.removeClass("wplng-status-reviewed"),n.removeClass("wplng-status-ungenerated"),this.checked?n.addClass("wplng-status-reviewed"):n.addClass("wplng-status-generated")}),s.find(".wplng-edit-language textarea").each(function(){s.find("#wplng_mark_as_reviewed_"+o(this).attr("lang")).prop("disabled",""==o(this).val().trim())}),s.find(".wplng-edit-language textarea").on("keyup paste",function(){var n=s.find("#wplng-translation-"+o(this).attr("lang")),e=s.find("#wplng_mark_as_reviewed_"+o(this).attr("lang"));n.removeClass("wplng-status-generated"),n.removeClass("wplng-status-reviewed"),n.removeClass("wplng-status-ungenerated"),""==o(this).val().trim()?(n.addClass("wplng-status-ungenerated"),e.prop("checked",!1),e.prop("disabled",!0)):(n.addClass("wplng-status-reviewed"),e.prop("checked",!0),e.prop("disabled",!1))}),s.find(".wplng-generate-spin").hide(),s.find(".wplng-generate").on("click",function(){var n,l,e,i;"disabled"!=o(this).attr("disabled")&&(n=s.find("#wplng-original-language").attr("wplng-lang"),l=s.find(this).attr("wplng-lang"),e=s.find("#wplng-source").html(),null!=n)&&null!=l&&null!=e&&(i="#wplng-translation-"+l,s.find(i+" .wplng-generate").attr("disabled",!0),s.find(i+" .wplng-generate-spin").show(),o.ajax({url:wplngLocalize.ajaxUrl,method:"POST",data:{action:"wplng_ajax_translation",text:e,language_source:n,language_target:l},success:function(n){var e,a,t;n.success?(o(e="#wplng_translation_"+l).val(n.data),""!=n.data&&(a=s.find("#wplng-translation-"+l),t=s.find("#wplng_mark_as_reviewed_"+l),a.removeClass("wplng-status-generated"),a.removeClass("wplng-status-reviewed"),a.removeClass("wplng-status-ungenerated"),a.addClass("wplng-status-reviewed"),t.prop("checked",!0),t.prop("disabled",!1)),g(o(e)),d(),o(i+" .wplng-generate-spin").hide(),setTimeout(function(){s.find(i+" .wplng-generate").attr("disabled",!1)},8e3)):(console.log("wpLingua - Error:"),console.log(n),s.find(i+" .wplng-generate-spin").removeClass("dashicons-update").removeClass("wplng-spin").addClass("dashicons-no"))},error:function(n){console.log("wpLingua - Error:"),console.log(n),s.find(i+" .wplng-generate-spin").removeClass("dashicons-update").removeClass("wplng-spin").addClass("dashicons-no")}}))}),s.find(".wplng-edit-language textarea, .wplng-edit-language input").on("change input propertychange",d),o("#submitpost [type=submit], #wplng-modal-edit-save").click(function(){e=!0}),o(window).on("beforeunload",function(){if(!e&&a.onload!=a.now)return confirm(wplngLocalize.message.exitPage)})}o("#wplng-modal-edit-show-all").on("click",function(){o(this).hide(),s.find(".wplng-edit-language").show()});let e=!1,a={onload:i(),now:i()};function i(){let n="";return s.find(".wplng-edit-language textarea").each(function(){n+=o(this).val()}),s.find(".wplng-edit-language input[type=checkbox]").each(function(){n+=o(this).prop("checked")}),n}function d(){a.now=i(),a.onload==a.now?o("#wplng-modal-edit-save").prop("disabled",!0):o("#wplng-modal-edit-save").prop("disabled",!1)}t(),o(".wplng-edit-link[wplng_post]").click(function(){o("#wplng-modal-edit-save").text(wplngLocalize.message.buttonSave),o("#wplng-modal-edit-save").prop("disabled",!0);let a=o(this).attr("wplng_post");o.ajax({url:wplngLocalize.ajaxUrl,method:"POST",data:{action:"wplng_ajax_edit_modal",post_id:a},success:function(n){var e;n.success?(e=function(n){let e=n;return e=(e=(e=(e=(e=e.replace(/&nbsp;/gi," ")).replace(/&amp;/gi,"&")).replace(/&quot;/gi,'"')).replace(/&lt;/gi,"<")).replace(/&gt;/gi,">")}((e=JSON.parse(n.data)).wplng_edit_html),s.html(e),o("#wplng-modal-edit-container").show(),o("#wplng-modal-container").hide(),o("#wplng-modal-edit-save").attr("wplng_post",a),1==s.find(".wplng-edit-language").length?o("#wplng-modal-edit-show-all").hide():o("#wplng-modal-edit-show-all").show(),t(),e=(e=".wplng-edit-language:not([wplng-lang=")+wplngLocalize.currentLanguage+"])",s.find(e).hide()):(console.log("wpLingua - Error:"),console.log(n))},error:function(n){console.log("wpLingua - Error:"),console.log(n)}})}),o("#wplng-modal-edit-return").click(function(){(a.onload==a.now||confirm(wplngLocalize.message.exitEditorModal))&&l()}),o("#wplng-modal-edit-save").click(function(){o("#wplng-modal-edit-save").text(wplngLocalize.message.buttonSaveInProgress);let e=o(this).text(),a=o(this).attr("wplng_post"),t={action:"wplng_ajax_save_modal",post_id:a,wplng_translation_meta_box_nonce:s.find("#wplng_translation_meta_box_nonce").val()};s.find(".wplng-translation-textarea").each(function(){var n=o(this).attr("id");t[n]=o(this).val(),"wplng_translation_"+wplngLocalize.currentLanguage==n&&(e=o(this).val())}),s.find(".wplng-mark-as-reviewed input[type=checkbox]").each(function(){t[o(this).attr("id")]=o(this).prop("checked")}),o.ajax({url:wplngLocalize.ajaxUrl,method:"POST",data:t,success:function(n){n.success?(o("body.wplingua-editor .wplng-edit-link[wplng_post="+a+"]").text(e),o("body.wplingua-list .wplng-modal-item[wplng_post="+a+"] .wplng-item-translation").text(e),l()):(console.log("wpLingua - Error:"),console.log(n))},error:function(n){console.log("wpLingua - Error:"),console.log(n)}})})});//# sourceMappingURL=translation.js.map
